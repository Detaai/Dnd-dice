<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>D&D Dice Roller</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&display=swap');
        :root{
            --bg-1: #071025;
            --bg-2: #0e0920;
            --card: rgba(255,255,255,0.03);
            --muted: #bfb7c9;
            --accent: #8f5aff;
            --accent-2: #c9a3ff;
            --glass: rgba(255,255,255,0.03);
            --card-border: rgba(255,255,255,0.02);
            --card-shadow: 0 10px 28px rgba(8,6,25,0.36);
        }
        html,body{height:100%;}
        body {
            font-family: 'Inter', system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
            background: radial-gradient(900px 320px at 10% 12%, rgba(143,90,255,0.07), transparent), radial-gradient(700px 260px at 88% 78%, rgba(201,163,255,0.04), transparent), linear-gradient(180deg,var(--bg-1),var(--bg-2));
            background-blend-mode: screen, screen, normal;
            color: #eef2f7;
            margin: 0;
            -webkit-font-smoothing:antialiased;
            -moz-osx-font-smoothing:grayscale;
        }
        .container{max-width:1180px;margin:32px auto;padding:0 18px;}
        h1,h2,h3{margin:0 0 8px 0}
        #dice-title{font-weight:800;margin-top:8px;color:var(--accent);letter-spacing:0.6px}
        .char-header{display:flex;align-items:center;justify-content:space-between;gap:18px;padding:12px;border-radius:14px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border:1px solid var(--card-border);box-shadow:var(--card-shadow)}
        .char-name{font-size:1.45rem;color:#fff}
        .char-sub{color:var(--muted)}
        .char-left{display:flex;flex-direction:column;gap:6px}
        .char-right{display:flex;flex-direction:column;gap:8px;align-items:flex-end}

        /* Cards grid */
        .cards-grid{display:grid;grid-template-columns:1fr;gap:20px;margin-top:18px;justify-items:center}
        @media(min-width:980px){.cards-grid{grid-template-columns:1fr 1fr}}
        .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;padding:18px;border:1px solid var(--card-border);box-shadow:var(--card-shadow);width:100%;max-width:560px;transition:transform .18s cubic-bezier(.2,.9,.2,1),box-shadow .18s ease;border-left:6px solid transparent}
        .card:hover{transform:translateY(-6px);box-shadow:0 18px 36px rgba(3,9,18,0.45);border-left-color:transparent}
        .card h3{font-size:1.15rem;color:var(--accent-2);text-align:center}

        /* Buttons */
        button{font-family:inherit}
        .btn{display:inline-flex;align-items:center;gap:8px;border-radius:10px;padding:10px 14px;border:none;cursor:pointer;font-weight:600}
        .btn:disabled{opacity:0.5;cursor:not-allowed;filter:grayscale(20%)}
        .weapon-btn{background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));color:#fff;border:1px solid rgba(255,255,255,0.04);padding:10px 14px;border-radius:10px;transition:transform .12s ease,box-shadow .12s ease,filter .12s ease;box-shadow:0 8px 18px rgba(2,6,23,0.45)}
        .weapon-btn:hover{transform:translateY(-3px);filter:brightness(1.02);box-shadow:0 18px 36px rgba(2,6,23,0.5)}

        .primary-action{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#07211f;border:0;padding:12px 18px;border-radius:10px}
        .primary-action:hover{filter:brightness(.98);transform:translateY(-3px)}
        .secondary-action{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#e6eef3}

        /* Magic UI toggles */
        .segmented{display:flex;gap:8px;justify-content:center}
        .seg-btn{padding:8px 12px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--muted);cursor:pointer}
        .seg-btn.active{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#07211f;border-color:transparent}
        .spell-tabs{display:flex;gap:8px;margin-top:8px}
        .tab{padding:6px 10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.03);color:var(--muted);cursor:pointer}
        .tab.active{background:rgba(255,255,255,0.06);color:#fff}

        /* Panels */
        .panel{display:none;animation:fadeIn .18s ease forwards}
        .panel.visible{display:block}

        @keyframes fadeIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:translateY(0)}}

        /* Results */
        #weapon-output{min-height:120px;text-align:center;padding:12px;border-radius:8px;background:linear-gradient(180deg, rgba(0,0,0,0.12), transparent);box-shadow:inset 0 -6px 18px rgba(0,0,0,0.2)}
        #magic-output{color:#e8d7ff}
        #spell-slots{font-weight:700;color:var(--muted);margin-top:10px;text-align:center}

        /* small helpers */
        .card-actions{display:flex;flex-wrap:wrap;gap:10px;justify-content:center}
        .char-field{background:transparent;border:1px solid rgba(255,255,255,0.02);padding:10px 14px;border-radius:8px}
        .char-header{align-items:center}

        /* Initiative & Currency specific tweaks */
        #initiative-list div{background:linear-gradient(90deg,rgba(255,255,255,0.01),transparent);padding:6px;border-radius:6px}
        #currency-gp{color:#ffd54a}
        #currency-sp{color:#c0c0ff}
        #currency-cp{color:#b87333}

        /* Bottom bumber/footer */
        .bumber{position:fixed;left:12px;right:12px;bottom:12px;background:linear-gradient(90deg,rgba(166,120,255,0.08),rgba(214,179,255,0.06));backdrop-filter:blur(6px);padding:10px 14px;border-radius:10px;border:1px solid rgba(166,120,255,0.12);display:flex;align-items:center;justify-content:space-between;gap:12px;z-index:2200}
        .bumber .text{color:#e9dbff;font-size:0.95rem}
        .bumber .muted{color:var(--muted);font-size:0.85rem}
        .bumber .close-btn{background:transparent;border:1px solid rgba(255,255,255,0.06);color:#fff;padding:6px 8px;border-radius:8px;cursor:pointer}
    </style>
    <style>
        /* Life gain / lose visuals */
        .life-effect-img { position: fixed; pointer-events: none; width: auto; height: 96px; transform-origin: center; z-index: 99999; opacity: 0; will-change: transform, opacity; }

        @keyframes gainLife {
            0% { transform: translateY(0) scale(0.72) rotate(0deg); opacity: 0; filter: drop-shadow(0 6px 14px rgba(80,255,150,0.18)); }
            10% { opacity: 1; }
            60% { transform: translateY(-120px) scale(1.06) rotate(-6deg); opacity: 1; filter: drop-shadow(0 18px 40px rgba(80,255,150,0.32)); }
            100% { transform: translateY(-220px) scale(0.92) rotate(-8deg); opacity: 0; }
        }

        @keyframes loseLife {
            0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 1; filter: drop-shadow(0 6px 12px rgba(255,80,80,0.18)); }
            30% { transform: translateY(-12px) rotate(6deg) scale(1.02); opacity: 1; }
            60% { transform: translateY(8px) rotate(-8deg) scale(0.98); opacity: 0.9; filter: blur(0.6px) drop-shadow(0 24px 36px rgba(255,40,40,0.42)); }
            100% { transform: translateY(40px) scale(0.6) rotate(-12deg); opacity: 0; }
        }

        .life-effect-gain { animation: gainLife 1000ms cubic-bezier(.2,.9,.3,1); }
        .life-effect-lose { animation: loseLife 900ms cubic-bezier(.2,.9,.3,1); }

        /* Particle-style PNG copies */
        .life-particle { position: fixed; pointer-events: none; z-index: 99999; will-change: transform, opacity, filter; mix-blend-mode: screen; opacity: 0; }
        .life-particle.gain { mix-blend-mode: screen; filter: drop-shadow(0 8px 18px rgba(80,255,150,0.18)); }
        .life-particle.lose { mix-blend-mode: multiply; filter: grayscale(1) contrast(1.1) drop-shadow(0 8px 18px rgba(0,0,0,0.28)); }

        @keyframes particleMove {
            0% { opacity: 0; transform: translate(0,0) scale(0.2) rotate(0deg); }
            10% { opacity: 1; }
            70% { opacity: 1; }
            /* Move to the CSS-provided dx/dy; defaults favor horizontal motion */
            100% { opacity: 0; transform: translate(var(--dx, 0px), var(--dy, 0px)) scale(var(--scale,1)) rotate(var(--rot,0deg)); }
        }

        .particle-anim { animation-name: particleMove; animation-timing-function: cubic-bezier(.15,.9,.25,1); animation-fill-mode: forwards; }

        /* Floating close-inventory button image on far left */
        .floating-inventory {
            position: fixed;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 200px;
            height: auto;
            z-index: 99998;
            pointer-events: auto;
            cursor: pointer;
            transition: transform .18s ease, opacity .18s ease;
            opacity: 0.92;
            filter: drop-shadow(0 8px 18px rgba(0,0,0,0.35));
        }
        .floating-inventory:hover { transform: translateY(-50%) scale(1.06); opacity: 1; }
    </style>
    <style>
        /* Subtle textured overlay to add depth and tie accent colors together */
        body::before{
            content: '';
            position: fixed;
            inset: 0;
            pointer-events: none;
            /* very subtle fabric-like sheen instead of hard repeating lines */
            background-image: linear-gradient(135deg, rgba(255,255,255,0.002) 0%, rgba(255,255,255,0.001) 100%);
            opacity: 0.035;
            mix-blend-mode: overlay;
            z-index: 0;
        }
        /* Gentle vignette to focus content */
        body::after{
            content: '';
            position: fixed;
            inset: 0;
            pointer-events: none;
            background: radial-gradient(60% 60% at 50% 40%, rgba(0,0,0,0) 0%, rgba(0,0,0,0.18) 70%);
            opacity: 0.32;
            z-index: 0;
        }
        /* Ensure main container sits above overlays */
        .container, .cozy-container{position:relative;z-index:1}
        .char-header, .card{background-blend-mode:overlay}
    </style>
    <style>
        /* Low-health heartbeat overlay */
        @keyframes heartbeatPulse {
            0% { opacity: 0; transform: scale(1); }
            25% { opacity: 0.06; transform: scale(1.005); }
            50% { opacity: 0.12; transform: scale(1.01); }
            75% { opacity: 0.06; transform: scale(1.005); }
            100% { opacity: 0; transform: scale(1); }
        }
        #health-overlay { position: fixed; inset: 0; pointer-events: none; z-index: 20; opacity: 0; transition: opacity .2s ease; }
        /* Two layered theme tints that animate inverse opacities to create a purple->red beat */
        #health-overlay .theme-purple, #health-overlay .theme-red { position:absolute; inset:0; pointer-events:none; mix-blend-mode: color; opacity:0; }
        #health-overlay .theme-purple { background: radial-gradient(circle at 20% 15%, rgba(143,90,255,0.12), transparent 30%), radial-gradient(circle at 85% 80%, rgba(201,163,255,0.06), transparent 40%); }
        #health-overlay .theme-red { background: radial-gradient(circle at 50% 18%, rgba(255,80,80,0.18), rgba(255,40,40,0.06) 30%, transparent 50%); }

        @keyframes purplePulse { 0%{opacity:0.14} 50%{opacity:0} 100%{opacity:0.14} }
        @keyframes redPulse    { 0%{opacity:0}    50%{opacity:0.16} 100%{opacity:0} }

        #health-overlay .pulse { position: absolute; inset: 0; pointer-events:none; }

        body.low-health #health-overlay { opacity: 1; }
        body.low-health #health-overlay .theme-purple { animation: purplePulse 1.2s ease-in-out infinite; }
        body.low-health #health-overlay .theme-red { animation: redPulse 1.2s ease-in-out infinite; }
        body.low-health #health-overlay .pulse { animation: heartbeatPulse 1.2s ease-in-out infinite; }

        /* Accent variable pulse: switch purple accents to red during the heartbeat
           Many styles use the CSS variables --accent and --accent-2; animating
           these in a keyframe makes accented elements flip color during the pulse. */
        @keyframes accentPulse {
            0%, 100% {
                --accent: #8f5aff;
                --accent-2: #c9a3ff;
                --bg-1: #071025;
                --bg-2: #0e0920;
            }
            50% {
                --accent: #ff6b6b;
                --accent-2: #ffb3b3;
                /* shift the page background toward deep red tints at pulse peak */
                --bg-1: #2d0006;
                --bg-2: #1a0004;
            }
        }
        body.low-health { animation: accentPulse 1.2s linear infinite; }

        /* Smooth transitions for common accent usages */
        .char-name, .card h3, .prof-badge, #ac-large { transition: color .28s ease, background .28s ease, border-color .28s ease; }
        .card { transition: box-shadow .28s ease, border-left-color .28s ease, background .28s ease; }

        /* Critical theme layer (black pulse) */
        #health-overlay .theme-critical { position:absolute; inset:0; pointer-events:none; mix-blend-mode:multiply; background: radial-gradient(circle at 50% 40%, rgba(0,0,0,0.0), rgba(0,0,0,0.85) 60%); opacity:0; }
        @keyframes criticalPulse { 0%{opacity:0} 40%{opacity:0.45} 60%{opacity:0.75} 100%{opacity:0} }
        #health-overlay .theme-critical { transition: opacity .2s ease; }

        /* Critical health animation: deep red accents and stronger background darkening */
        @keyframes accentCritical {
            0%,100% {
                --accent: #8b0000;
                --accent-2: #b30000;
                --bg-1: #220002;
                --bg-2: #120001;
            }
            50% {
                --accent: #ff0f0f;
                --accent-2: #ff6b6b;
                --bg-1: #2b0000;
                --bg-2: #150000;
            }
        }
        body.critical-health { animation: accentCritical 0.9s linear infinite; }
        body.critical-health #health-overlay { opacity: 1; }
        body.critical-health #health-overlay .theme-critical { animation: criticalPulse 0.9s ease-in-out infinite; }
    </style>
    <style>
        /* Cozy layout adjustments */
        .cozy-container{max-width:1200px;padding:34px 26px;margin:32px auto;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00));border-radius:16px}
        .card{padding:22px;border-radius:14px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.008));box-shadow:0 22px 48px rgba(2,6,23,0.45);margin-bottom:12px}
        .card h3{margin-bottom:10px}
        .char-header{gap:26px;padding:20px}
        .char-left{gap:10px}
        .char-right{gap:12px}
        .stats-panel{min-width:360px;padding:14px}
        .cards-grid{grid-template-columns:1fr;gap:22px}
        @media(min-width:980px){.cards-grid{grid-template-columns:1fr 1fr}}
        /* Section separators and cozy headings */
        .cozy-section{margin-top:20px;padding:14px;border-radius:12px;background:linear-gradient(180deg,rgba(0,0,0,0.04),transparent);border:1px solid rgba(255,255,255,0.02)}
        .cozy-heading{font-weight:800;color:var(--accent-2);margin-bottom:10px}
        /* Slightly larger gaps inside stats for breathing room */
        .stats-column{gap:16px}
        .stat-card{min-width:84px;min-height:86px;padding:10px 8px}
        .stat-score{font-size:1.3rem}
        .stat-mod{padding:8px 12px}
        .char-field{padding:10px 14px}
        .card-actions{gap:12px}
        #dice-faces{gap:26px}
        #dice-total{margin-top:26px}
        @media(max-width:600px){.stats-panel{min-width:unset;width:100%}}
        /* Smooth dice number transitions */
        .dice-number{transition:opacity .14s ease, transform .14s ease}
        .dice-number.fading{opacity:0;transform:translateY(-6px) scale(0.95)}
        #dice-total{transition:opacity .2s ease, transform .2s ease}
        #weapon-output .recent-value{transition:transform .18s ease, opacity .18s ease}
    </style>
    <style>
        /* Locked/read-only visuals for Infusions */
        .locked { user-select: none; pointer-events: none; opacity: 0.98; }
        .infusions-card { border-left-color: rgba(90, 200, 180, 0.18); }
        .infusion-meta { text-align:center; color:var(--muted); font-weight:700; margin-bottom:8px }
        .infusion-list { padding:12px; display:flex;flex-direction:column;gap:8px }
        .infusion-item { color:#e8e8e8; background:rgba(255,255,255,0.02); padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03) }
        .infusion-note { color:#ffd; font-weight:700; margin-top:8px; text-align:center }
        .infusion-sub { color:var(--muted); font-size:0.95rem; text-align:center; margin-top:6px }
    </style>
        <style>
        /* Ability scores column (locked/read-only) */
        .header-row{display:flex;align-items:center;gap:18px}
        .stats-panel{background:linear-gradient(180deg, rgba(10,6,20,0.6), rgba(20,12,40,0.45));padding:10px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);box-shadow:0 8px 24px rgba(2,6,23,0.6);}
        .stats-column{display:flex;flex-direction:row;gap:12px;align-items:center;margin-right:6px;flex-wrap:wrap;justify-content:center}
        .stat-card{width:74px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.04);border-radius:10px;padding:8px 6px;display:flex;flex-direction:column;align-items:center;gap:6px;min-height:72px}
        .stat-score{font-weight:900;font-size:1.25rem;color:#fff;letter-spacing:0.6px}
        .stat-mod{background:linear-gradient(90deg,#2b1b3a,#5b3fd6);border-radius:999px;padding:6px 10px;color:#fff;font-weight:800;font-size:0.95rem;border:1px solid rgba(255,255,255,0.06);box-shadow:0 6px 14px rgba(91,63,214,0.12)}
        .stat-label{color:var(--muted);font-size:0.75rem}
        .stat-card.locked{pointer-events:none;user-select:none;opacity:1}
        /* Decorative top marker to mimic the attached vertical graphic */
        .stats-panel::before{content:'';display:block;width:40px;height:10px;margin:0 auto 6px auto;background:linear-gradient(90deg,#fff1,#fff0);border-radius:8px;opacity:0.06}
        /* AC large styling */
        #ac-large{font-size:1.05rem;font-weight:800;color:var(--accent-2);margin-top:6px}
        /* Hover tooltip for armor formula */
        .char-field .ac-hover-tip{pointer-events:none}
        .char-field:hover .ac-hover-tip{opacity:1;transform:translateY(0);pointer-events:auto}
        /* Proficiency and skills */
        .prof-badge{width:56px;height:56px;border-radius:10px;background:linear-gradient(90deg,#3b2b6a,#6f4ef0);display:flex;align-items:center;justify-content:center;font-weight:900;color:#fff;font-size:1.1rem;box-shadow:0 8px 20px rgba(50,30,120,0.18)}
        .skills-list{margin-top:8px;color:#e8e8e8;display:flex;flex-wrap:wrap;gap:8px;list-style:none;padding:0;margin:8px 0 0 0}
        .skills-list li{margin:0;background:rgba(255,255,255,0.02);padding:6px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03)}
    </style>
</head>
<body>
    <div class="container cozy-container">
        <div class="char-header">
            <div class="char-left">
                <div class="char-name" contenteditable="true">Thaine</div>
                <div class="char-sub" contenteditable="true">Ranger Artificer • Level 5 • Half elf</div>
                <div style="display:flex;gap:10px;align-items:center;margin-top:8px;">
                    <div id="ac-large" class="char-name" contenteditable="true" style="margin:0;padding:6px 10px;border-radius:8px;background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#07211f;font-weight:800;">AC: 15</div>
                    <div style="background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);padding:8px 10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);">HP: <span id="health-header" style="font-weight:800;color:#fff;">45 / 45</span></div>
                </div>
                <div style="margin-top:8px;display:flex;gap:10px;align-items:center;">
                    <div class="char-field" style="position:relative;">
                        Armor: <span id="armor-type" style="font-weight:700;color:#ffd">Studded Leather</span>
                        <div id="ac-explain" class="ac-hover-tip" style="display:block;opacity:0;transform:translateY(-6px);transition:all .18s ease;position:absolute;left:0;top:calc(100% + 8px);background:rgba(0,0,0,0.6);padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);min-width:220px;color:var(--muted);z-index:40;">12 (studded leather) + Dex mod (+4) = <strong id="ac-calc">16</strong></div>
                    </div>
                </div>
                <div style="display:flex;gap:8px;margin-top:8px;">
                    <div class="char-field">Class: <span contenteditable="true">Ranger Artificer</span></div>
                    <div class="char-field">Level: <span contenteditable="true">5</span></div>
                    <div class="char-field">Race: <span contenteditable="true">Half elf</span></div>
                    <div class="char-field">Speed: <span id="speed-display" style="font-weight:700;color:#ffd">20 ft</span></div>
                </div>
            </div>
            <div class="stats-panel">
                <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;">
                    <div style="display:flex;align-items:center;gap:12px;">
                        <div style="font-weight:800;color:#ffd9f7">Ability Scores</div>
                        <div class="prof-badge" title="Proficiency Bonus">+3</div>
                    </div>
                    <div style="color:var(--muted);font-size:0.85rem">Locked</div>
                </div>
                <div class="stats-column">
                    <div class="stat-card locked">
                        <div class="stat-label">STR</div>
                        <div class="stat-score">8</div>
                        <div class="stat-mod">-1</div>
                    </div>
                    <div class="stat-card locked">
                        <div class="stat-label">DEX</div>
                        <div class="stat-score">19</div>
                        <div class="stat-mod">+4</div>
                    </div>
                    <div class="stat-card locked">
                        <div class="stat-label">CON</div>
                        <div class="stat-score">14</div>
                        <div class="stat-mod">+2</div>
                    </div>
                    <div class="stat-card locked">
                        <div class="stat-label">INT</div>
                        <div class="stat-score">15</div>
                        <div class="stat-mod">+2</div>
                    </div>
                    <div class="stat-card locked">
                        <div class="stat-label">WIS</div>
                        <div class="stat-score">14</div>
                        <div class="stat-mod">+2</div>
                    </div>
                    <div class="stat-card locked">
                        <div class="stat-label">CHA</div>
                        <div class="stat-score">12</div>
                        <div class="stat-mod">+1</div>
                    </div>
                </div>
                <div style="margin-top:10px;">
                    <div style="font-weight:700;color:#fff;margin-bottom:6px;">Saving Throws</div>
                    <ul class="skills-list">
                        <li>Strength: <span style="color:var(--muted)">-1</span></li>
                        <li>Dexterity: <span style="color:var(--muted)">+4</span> <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Constitution: <span style="color:var(--muted)">+2</span></li>
                        <li>Intelligence: <span style="color:var(--muted)">+2</span></li>
                        <li>Wisdom: <span style="color:var(--muted)">+2</span> <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Charisma: <span style="color:var(--muted)">+1</span></li>
                    </ul>

                    <div style="font-weight:700;color:#fff;margin-top:8px;margin-bottom:6px;">Skills</div>
                    <ul class="skills-list">
                        <li>Acrobatics (Dex): +4</li>
                        <li>Animal Handling (Wis): +2</li>
                        <li>Arcana (Int): +2</li>
                        <li>Athletics (Str): -1</li>
                        <li>Deception (Cha): +1 <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>History (Int): +2</li>
                        <li>Insight (Wis): +2 <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Intimidation (Cha): +1</li>
                        <li>Investigation (Int): +2 <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Medicine (Wis): +2</li>
                        <li>Nature (Int): +2</li>
                        <li>Perception (Wis): +5 <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Performance (Cha): +1</li>
                        <li>Persuasion (Cha): +1 <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Religion (Int): +2</li>
                        <li>Sleight of Hand (Dex): +4</li>
                        <li>Stealth (Dex): +5 <strong style="color:#ffd;margin-left:6px;">(Proficient)</strong></li>
                        <li>Survival (Wis): +4</li>
                    </ul>
                </div>
            </div>
        </div>
        <h1 id="dice-title" style="cursor:pointer;">D&D Dice Roller</h1>
        <label id="choose-label" for="dice-select" style="cursor:pointer;">Choose a die:</label>
        <label for="dice-count">Number of dice:</label>
        <input type="text" id="dice-count" value="1" style="width:50px;">
        <div id="dice-selectors" style="margin:10px 0;"></div>
        <button id="roll-btn">Roll!</button>
        <div id="dice-faces" style="display:flex;justify-content:center;gap:20px;margin-top:20px;"></div>
        <div id="dice-total" style="font-size:2em;margin-top:20px;"></div>
        <div id="fail-message" style="display:none;font-size:3em;font-weight:bold;color:red;margin-top:30px;"></div>
    </div>
    
    <!-- Character Weapons Section -->
    <div class="container cozy-container" style="margin-top: 40px; padding-top: 30px;">
        <h2>Character Weapons</h2>
        
        <div class="cards-grid">
            <!-- Initiative Card -->
            <div class="card" id="initiative-card">
                <h3>Initiative</h3>
                <div class="card-actions">
                    <button class="weapon-btn" onclick="rollInitiative()">Roll Initiative (1d20 + 6)</button>
                    <button class="weapon-btn" onclick="showPdf('Thaine-lv-5.pdf','Thaine-lv-5.pdf')" style="margin-left:10px;">Open Thaine-lv-5.pdf</button>
                </div>
                    <div style="margin-top:12px; text-align:center;">
                    <div style="font-weight:800; font-size:0.95rem; color:var(--muted); margin-bottom:6px;">Health</div>
                    <div id="health-display" style="font-size:1.5rem; font-weight:700; color:#fff;">45 / 45
                    </div>
                    <div style="margin-top:10px;display:flex;gap:8px;justify-content:center;align-items:center;">
                        <input id="health-custom" type="number" placeholder="10" style="width:100px;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#fff;text-align:center;" />
                        <button class="weapon-btn secondary-action" onclick="applyCustomHealthSub()">Apply -</button>
                        <button class="weapon-btn secondary-action" onclick="applyCustomHealthAdd()">Apply +</button>
                    </div>
                </div>
            </div>

            <!-- Initiative Tracker -->
            <div class="card" style="max-width:560px;">
                <h3 style="color:var(--accent-2);">Initiative Tracker</h3>
                <div style="display:flex;gap:8px;align-items:center;justify-content:center;margin-bottom:8px;">
                    <input id="initiative-name" type="text" placeholder="Name (optional)" style="padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);width:60%;background:transparent;color:#fff;" />
                    <button class="weapon-btn" onclick="addLastInitiative()">Add Last Roll</button>
                </div>
                <div style="text-align:center;margin-bottom:8px;">
                    <button class="weapon-btn" onclick="sortInitiativeDesc()">Sort Desc</button>
                    <button class="weapon-btn" onclick="clearInitiative()" style="margin-left:8px;">Clear</button>
                </div>
                <div id="initiative-list" style="max-height:180px;overflow:auto;text-align:left;color:#fff;padding:8px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);"></div>
            </div>

            <!-- Currency Tracker -->
            <div class="card" style="max-width:560px;">
                <h3 style="color:var(--accent-2);">Currency</h3>
                <div style="display:flex;gap:8px;justify-content:center;align-items:center;margin-bottom:10px;">
                    <div style="text-align:center;">
                        <div style="color:var(--muted);font-size:0.85rem;margin-bottom:6px;">Gold</div>
                        <div id="currency-gp" style="font-weight:700;font-size:1.2rem;color:#ffd54a;">0</div>
                        <div style="margin-top:6px;"><button class="weapon-btn" onclick="changeCurrency('gp',1)">+1</button><button class="weapon-btn" onclick="changeCurrency('gp',-1)" style="margin-left:6px;">-1</button></div>
                    </div>
                    <div style="text-align:center;">
                        <div style="color:var(--muted);font-size:0.85rem;margin-bottom:6px;">Silver</div>
                        <div id="currency-sp" style="font-weight:700;font-size:1.2rem;color:#c0c0ff;">0</div>
                        <div style="margin-top:6px;"><button class="weapon-btn" onclick="changeCurrency('sp',1)">+1</button><button class="weapon-btn" onclick="changeCurrency('sp',-1)" style="margin-left:6px;">-1</button></div>
                    </div>
                    <div style="text-align:center;">
                        <div style="color:var(--muted);font-size:0.85rem;margin-bottom:6px;">Copper</div>
                        <div id="currency-cp" style="font-weight:700;font-size:1.2rem;color:#b87333;">0</div>
                        <div style="margin-top:6px;"><button class="weapon-btn" onclick="changeCurrency('cp',1)">+1</button><button class="weapon-btn" onclick="changeCurrency('cp',-1)" style="margin-left:6px;">-1</button></div>
                    </div>
                </div>
                <div style="text-align:center;color:var(--muted);">Values persist in localStorage.</div>
            </div>

            <!-- Magic Card (Primary actions) -->
            <div class="card magic" id="magic-card">
                <h3>Magic</h3>
                <div class="card-actions">
                    <button class="weapon-btn secondary-action" onclick="openMagicRingSelector()">Magic Rings</button>
                    <button class="weapon-btn secondary-action" onclick="shortRest()">Short Rest (4d10+1d8)</button>
                    <button class="weapon-btn secondary-action" onclick="longRest()" style="margin-left:8px;">Long Rest</button>
                </div>
                    <div id="ring-status" style="display: none; margin-top: 12px; padding: 12px; background: #333; border-radius: 8px; border: 2px solid #888; color:#fff;">
                        <h3 style="color: #0f0; margin-top:0;">Equipped Magic Rings</h3>
                        <div id="equipped-rings" style="text-align: left; color: #fff;"></div>
                    </div>
                    <div style="margin-top:12px;">
                        <div class="segmented">
                            <div class="seg-btn active" id="cantrip-toggle" onclick="showCantripPanel()">Cantrips</div>
                            <div class="seg-btn" id="spells-toggle" onclick="showSpellsPanel()">Spells</div>
                        </div>

                        <div id="cantrip-panel" class="panel visible">
                            <div class="card-actions" style="gap:10px; flex-wrap:wrap;">
                                <button class="weapon-btn primary-action" onclick="showCantrip('mending')">Mending</button>
                                <button class="weapon-btn primary-action" onclick="showCantrip('mage-hand')">Mage Hand</button>
                                <button id="disguise-btn" class="weapon-btn primary-action" onclick="toggleDisguiseSelf()">Disguise Self (Toggle)</button>
                            </div>
                        </div>

                        <div id="spells-panel" class="panel">
                            <div class="spell-tabs">
                                <div class="tab active" id="tab-action" onclick="showSpellGroup('action')">Action</div>
                                <div class="tab" id="tab-reaction" onclick="showSpellGroup('reaction')">Reaction</div>
                                <div class="tab" id="tab-bonus" onclick="showSpellGroup('bonus')">Bonus Action</div>
                            </div>
                            <div id="spells-action" class="panel visible">
                                <div class="card-actions" style="gap:10px; flex-wrap:wrap;">
                                    <button id="faerie-btn" class="weapon-btn primary-action" onclick="castFaerieFire()">Faerie Fire (Save)</button>
                                    <button id="cure-btn" class="weapon-btn primary-action" onclick="castCureWounds()">Cure Wounds</button>
                                </div>
                            </div>
                            <div id="spells-reaction" class="panel">
                                <div class="card-actions" style="gap:10px; flex-wrap:wrap;">
                                    <button id="absorb-btn" class="weapon-btn primary-action" onclick="toggleAbsorbElements()">Absorb Elements (Toggle)</button>
                                </div>
                            </div>
                            <div id="spells-bonus" class="panel">
                                <div class="card-actions" style="gap:10px; flex-wrap:wrap;">
                                    <button id="hunter-btn" class="weapon-btn primary-action" onclick="castHuntersMark()">Hunter's Mark</button>
                                    <button id="zephyr-btn" class="weapon-btn primary-action" onclick="castZephyrStrike()">Zephyr Strike</button>
                                </div>
                            </div>
                        </div>

                        <div id="spell-slots" style="margin-top:10px; color:#e8e8e8; font-weight:700;">Spell Slots: 5/5</div>
                        <div id="magic-output" style="margin-top:10px; color:#fff; text-align:left;"></div>
                        <div id="active-effects" style="margin-top:12px; text-align:left; color:#fff; display:block;">
                            <h4 style="margin:6px 0 8px 0; color:#ffd9f7;">Active Effects</h4>
                            <div id="active-effects-list" style="color:#e8e8e8;">No active effects.</div>
                        </div>
                    </div>
            </div>

            <!-- Weapons Card (Secondary actions) -->
            <div class="card" id="weapons-card">
                <h3>Weapons</h3>
                <div class="card-actions" style="margin-top:8px;">
                    <button class="weapon-btn secondary-action" onclick="openMagicWeaponSelector()">Magic Weapons</button>
                    <button id="crit-toggle" class="weapon-btn secondary-action" onclick="toggleCritNext()" style="margin-left:8px;">Crit Next Attack: Off</button>
                </div>
                <div id="weapon-status" style="display: none; margin-top: 12px; padding: 12px; background: #333; border-radius: 8px; border: 2px solid #666; color:#fff;">
                    <h4 style="color:#0f0;margin:0 0 8px 0;">Equipped Magic Weapons</h4>
                    <div id="equipped-weapons" style="text-align: left; color: #fff;"></div>
                </div>
                <div class="card-subsection">
                    <h4 style="margin:0 0 8px 0; color:#dfe6e9;">Short Range</h4>
                    <div class="card-actions">
                        <!--first turn:
                        Shortbow: 1d6
                        Dread Ambusher bonus: 1d8
                        Magic Shortbow: 1d6
                        Hunter’s Mark: 1d6
                        short bow: 1d6
                        DEX: +4
                        Sharpshooter: +10
                        Other turns:
                        Weapon Damage: 1d6
                        Magic Shortbow: 1d6
                        Hunter's Mark: 1d6
                        DEX Modifier: +4
                        Sharpshooter: +10
                        -->
                        <button class="weapon-btn secondary-action" data-attack="true" onclick="rollShortRangeFirstTurn()">First Turn (Shortbow: 1d6 + 1d8 Dread Ambusher +1d6 HM +1d6 Magic +4 Dex +10 Sharpshooter)</button>
                        <button class="weapon-btn secondary-action" data-attack="true" onclick="rollShortRangeOtherTurns()">Other Turns (Shortbow: 1d6 + 1d6 Magic + 1d6 HM +4 Dex +10 Sharpshooter + DC 12 Wis)</button>
                    </div>
                </div>
                <div class="card-subsection" style="margin-top:12px;">
                    <h4 style="margin:0 0 8px 0; color:#dfe6e9;">Long Range</h4>
                    <div class="card-actions">
                        <!-- first turn:
                        Longbow: 1d8
                        Dread Ambusher bonus: 1d8
                        Hunter’s Mark: 1d6
                        DEX: +4
                        Sharpshooter: +10 
                        Other turns: 
                        Weapon Damage: 1d8
                        Hunter's Mark: 1d6
                        DEX Modifier: +4
                        Sharpshooter: +10
                        -->
                        <button class="weapon-btn secondary-action" data-attack="true" onclick="rollLongRangeFirstTurn()">First Turn (Longbow: 1d8 + 1d8 Dread Ambusher +1d6 HM +4 Dex +10 Sharpshooter)</button>
                        <button class="weapon-btn secondary-action" data-attack="true" onclick="rollLongRangeOtherTurns()">Other Turns (Longbow: 1d8 + 1d6 HM +4 Dex +10 Sharpshooter)</button>
                    </div>
                </div>
                <!-- Infusions read-only display (locked) -->
                <div class="card-subsection" style="margin-top:14px;">
                    <h4 style="margin:0 0 8px 0; color:#dfe6e9;">Infusions (Locked)</h4>
                    <div class="infusions-card card locked" style="padding:12px; background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent);">
                        <div class="infusion-meta">Infusions Known: <span style="color:#ffd;">4</span> &nbsp;•&nbsp; Active Slots: <span style="color:#ffd;">2</span></div>
                        <div class="infusion-list">
                            <div class="infusion-item">‑ Repeating Shot → Longbow (+1 to hit, +1 to damage, magical, creates ammo)</div>
                            <div class="infusion-item">‑ Enhanced Defense → Armor (+1 AC)</div>
                            <div class="infusion-item">‑ Enhanced Weapon</div>
                            <div class="infusion-item">‑ Mind Sharpener</div>
                        </div>
                        <div class="infusion-note">All infusions are locked until Artificer Level 2</div>
                        <div class="infusion-sub">Weapon Update (display-only): Longbow shows +1 to hit and +1 to damage (not yet applied)</div>
                        <div class="infusion-sub">AC Update (display-only): Armor shows +1 AC (not yet applied)</div>
                    </div>
                </div>
            </div>

            <!-- Results Card -->
            <div class="card" id="results-card">
                <h3>Results</h3>
                <div id="weapon-output" style="font-size: 1.5em; color: #0f0;"></div>
            </div>
        </div>

        <!-- Magic Ring Selection Modal -->

        <div id="ring-selector-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center;">

            <div style="background: #333; padding: 30px; border-radius: 10px; border: 2px solid #888; max-width: 500px; width: 90%;">

                <h3 style="margin-top: 0; color: #0f0;">Select Magic Rings (Max 3)</h3>

                <div id="ring-list" style="margin: 20px 0; text-align: left;">

                    <label style="display: block; margin: 10px 0; padding: 10px; background: #444; border-radius: 5px; cursor: pointer;">

                        <input type="checkbox" value="echo-band" style="margin-right: 10px;">

                        <span style="color: #fff; font-weight: bold;">Echo Band</span>

                        <div style="color: #aaa; font-size: 0.9em; margin-top: 5px; margin-left: 25px;">Create an echo of any object that fully passes through, this echo follows the exact path of the original and cannot be separated, the echo only lasts for one minute and does half damage</div>

                    </label>

                </div>

                <div style="margin-top: 20px; text-align: center;">

                    <button class="weapon-btn" onclick="confirmRingSelection()" style="margin: 5px;">Continue</button>

                    <button class="weapon-btn" onclick="closeRingSelector()" style="margin: 5px;">Cancel</button>

                </div>

            </div>

        </div>
    </div>

        <!-- Magic Weapon Selection Modal -->

        <div id="weapon-selector-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; justify-content: center; align-items: center;">

            <div style="background: #333; padding: 30px; border-radius: 10px; border: 2px solid #888; max-width: 600px; width: 90%;">

                <h3 style="margin-top: 0; color: #0f0;">Select Magic Weapons (Max 3)</h3>

                <div id="weapon-list" style="margin: 20px 0; text-align: left; max-height: 300px; overflow:auto;">

                    <label style="display: block; margin: 10px 0; padding: 10px; background: #444; border-radius: 5px; cursor: pointer;">

                        <input type="checkbox" value="dupo-quiver" style="margin-right: 10px;">

                        <span style="color: #fff; font-weight: bold;">Dupo Quiver</span>

                        <div style="color: #aaa; font-size: 0.9em; margin-top: 5px; margin-left: 25px;">Knock on wood two times and your shot is doubled! You are able to hit up to 2 targets!</div>

                    </label>

                </div>

                <div style="margin-top: 20px; text-align: center;">

                    <button class="weapon-btn" onclick="confirmWeaponSelection()" style="margin: 5px;">Continue</button>

                    <button class="weapon-btn" onclick="closeWeaponSelector()" style="margin: 5px;">Cancel</button>

                </div>

            </div>

        </div>

    <div id="pdf-viewer-modal" style="display:none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 2000; justify-content: center; align-items: center;">
        <div style="width: 90%; height: 90%; background: #111; border-radius: 8px; padding: 12px; box-sizing: border-box; position: relative;">
            <button class="weapon-btn" onclick="closePdfViewer()" style="position: absolute; top: 12px; right: 12px;">Close</button>
            <iframe id="pdf-frame" src="" style="width:100%; height:100%; border: none; border-radius: 6px;"></iframe>
        </div>
    </div>
    
    <script src="dice.js"></script>
    
    <!-- Bottom bumber / footer -->
    <div id="bumber" class="bumber">
        <div class="text"><strong>D&amp;D Dice Roller</strong> — Local • <span class="muted">v69.63</span></div>
        <div style="display:flex;gap:8px;align-items:center;">
            <div class="muted">Made with ❤️ — enjoy rolling!</div>
            <button class="close-btn" onclick="toggleBumber()">Hide</button>
        </div>
    </div>
    <!-- Floating close-inventory image (far left) -->
    <img src="close-inventory.png" alt="Close Inventory" class="floating-inventory" id="floating-inventory" />
</body>
    <div id="health-overlay">
        <div class="theme-purple"></div>
        <div class="theme-red"></div>
        <div class="theme-critical"></div>
        <div class="pulse"></div>
    </div>
</html>
